# 读取MPU数据
## 1 MPU9250简介
&emsp;3X3X1mm 的封装中融合了 3
轴加速度、3 轴陀螺仪、3 轴磁力计以及数字运动处理器（DMP）并且兼容 MPU6515。 其完美的 **I2C** 方案，可直接输出**9 轴的全部数据**：
* 三个 16 位加速度 AD 输出，：-32768 -- +32768
* 三个 16 位陀螺仪 AD 输出，
* 三
个 6 位磁力计 AD 输出

&emsp;该装置提供 **I2C** 和 **SPI** 的接 口， 2.4-3.6V 的供电电压，还有单独的数字 IO 口，支持 1.71V 到 VDD。通信 采用 400KHz 的 I2C 和 1MHz 的 SPI，若需要更快的速度，可以用 SPI 在 20MHz 的 模式下直接读取传感器和中断寄存器。

##  2 读取数据
&emsp;MPU9250 和 FBM320 与 MCU 通信时，一般都是作为 IIC
从机，MCU 为主机。
### 2.1 数据步骤

<img src = 'picture\8.1.PNG'>  

*  MPU9250 作为从机时的地址为 7 位 110100X（B）。这个地址的 LSB 位由
AD0 引脚的电平确定，这样就使得一个系统中可以同时连接 2 个 MPU9250 了。 （AD0 为低电平时 X 为 0，高电平 X 则为 1）。我们 DragonFly 四轴里面只用 了一个 MPU9250，**由图 11-1 可知 AD0 接高电平，所以 X 为 1。那么 MPU9250 的地 址为 1101001(B)**,十六进制表示为 **0x69**。

* **MPU9250 的初始化流程**：*（配置 MPU9250 初始化需要通读《MPU-9250-Register-Map》手册，然后找到 相应寄存器配置成我们需要的模式*）
1. 检查 MCU 与 MPU9250 是否通信成功：检查 MCU 与 MPU9250 是否正常通信，就是读取 WHO AM I 寄存器里的值是否
等于 **0x71**
2. 设置 MPU9250 为复位状态+100ms 复位延时 ：复位时电源管理1寄存器需要写入的值 是 0x80。复位需要时间，所以设置寄存器后需要延时 100ms。
3. 唤醒 MPU9250,选择 PLL 为时钟源 
4. 配置六轴数据(3 轴加速度+3 轴陀螺仪)全输出 ：复位后开启六轴传感器数据都输出，由电源管理 2 描述
5. 禁止所有中断 ：四轴用的是轮询读
取原始数据的方法，所以不需要开启任何中断，将该寄存器设置为 0x00 即可
6. 设置 MPU9250 内部采样频率 ：SMPLRT_DIV[7:0]的大小来改变 MPU9250 的采样频率，  
采样频率 = 陀螺仪输出频率/(1+SMPLRT_DIV)  
四轴的姿态解算频率为 500Hz,所以我们采样频率不 能低于 500Hz,这里我们就不分频了，让采样频率为 1KHz。SMPLRT_DIV[7:0]需要 设置成 0x00
7. 设置陀螺仪和加速度的满量程范围 8. 设置陀螺仪和加速度输出低通滤波

遥控器程序：
`E:\大学的文件\四旋翼\学习资料\02、源码\0202、四轴源码\旧版手柄套件源码\DragonFly 源码 V1.01版本\遥控器源码\DragonFly Remote Control`

四旋翼程序：
`E:\大学的文件\四旋翼\学习资料\02、源码\0202、四轴源码\新版手柄套件源码\DragonFLY Control with Remote\DragonFLY Control with Remote\USER`


#include <stdlib.h>
#include <stdio.h>
#include <math.h>

int main()
{

    return 0;
}